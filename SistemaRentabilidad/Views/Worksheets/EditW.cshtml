@using SistemaRentabilidad.Models
@model SistemaRentabilidad.ViewModels.WsVM
@{
    ViewBag.Title = "Editar Planilla";
}
<head><style>
    .glyphicon-remove {
    cursor: pointer !important;
    }
    .withoutborders {
           border-left: none;
           border-right: none;
           border-top: none;
        border-bottom-color: mediumseagreen;
           
       }

    legend {
    margin-bottom: 2px !important;
    font-size: inherit !important;
    }

    .montocentrado {
    text-align: center !important;
    }

    textarea {
    max-width: 100% !important;
    resize: none !important;
    line-height: 1.08 !important;
    }

    
    .inputForm {
    border-color: mediumseagreen !important;
    }

    .inputForm3 {
    border-color: #3498db !important;
    }


    #resumentabla td {
    line-height: 15px !important;
    }

    #nueva td {
    line-height: 15px !important;
    }

    #ingresotabla td {
    line-height: 15px !important;
    }

    #encabezadostabla td {
    line-height: 15px !important;
    }

    #costotabla td {
    line-height: 15px !important;
    }

    #gastotabla td {
    line-height: 15px !important;
    }

    #otrotabla td {
    line-height: 15px !important;
    }

    #ingresotabla th {
    line-height: 15px !important;
    }

    #costotabla th {
    line-height: 15px !important;
    }

    #gastotabla th {
    line-height: 15px !important;
    }

    #otrotabla th {
    line-height: 15px !important;
    }

    #nueva th {
    line-height: 15px !important;
    }

    #resumentabla th {
    line-height: 15px !important;
    }

    #otrosub th {
    line-height: 15px !important;
    }

    #encabezadostabla th {
    line-height: 15px !important;
    }

    #totalingresotabla th {
    line-height: 15px !important;
    }

    #totalgastotabla th {
    line-height: 15px !important;
    }

    #totalcostotabla th {
    line-height: 15px !important;
    }

    #totalotrotabla th {
    line-height: 15px !important;
    }

    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    margin: 0 !important;
    }

    .tipos {
    font-size: medium !important;
    font-weight: bold !important;
    font-style: italic !important;
    }

    .table {
    border-color: #252627 !important;
    margin-bottom: 0px !important;
    }
    </style>
</head>
@Html.HiddenFor(model => model.IdWorksheet)
<h2 class="text-center">Editar Planilla</h2>
<hr/>

<table id="titulotabla" class="table table-condensed table-bordered ">

    <thead>


        <tr class="text-center tipos thStyleGradient2 bordesRedond">
            <th class="text-center" style="width: 50%;padding: 2px">N° Planilla</th>

            <th class="text-center" tyle="padding: 2px">
                Período
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="dataContainer text-center">
                @Model.IdWorksheet
            </td>
            <td class="text-center inputForm2 ">
                @*@Html.TextBoxFor(model => model.Date.ToString("Y"), new { @onkeyup = "valwd()", @oninput = "valwd()", @onkeypress = "valwd()", @class = "inputForm2 panel-info" })*@
                <input id="Date" name="Date" type="text" readonly="readonly" onchange="valwd()" class="withoutborders form-control-sm" value="@Model.Date.ToString("MMMM/yyyy")" style="text-align: center;text-transform: capitalize" />
                <span id="wdate" class="text-danger" style="display: block"></span>
            </td>
        </tr>

    </tbody>

</table>
<hr style="margin-top: 2px; margin-bottom: 5px; border-style: dashed" />
<div style="display: inline-block">
    <button id="mostrar" class="hidden-print btn btn-primary btn-sm hvr-bubble-right">Agregar transacción&nbsp;&nbsp;</button>
    <div id="nuevalinea" style="display: none">
        <a style="margin-bottom: 2px; background: #89bad3">
            <button id="ocultar" class="hidden-print btn btn-xs btn-primary hvr-bubble-left positionOcultar">&nbsp;&nbsp; Ocultar</button>

        </a>
        <table id="nueva" class="table table-condensed table-bordered " style="margin-bottom: 2px; background: transparent;border-right: none">
            <thead>
                <tr class="text-center thStyleGradient3"  style="border-right: none">
                    <th class="text-center">
                        Tipo
                    </th>
                    <th class="text-left" style="width: 40%">
                        Transacción
                    </th>
                    <th class="text-left" style="width: 40%">
                        Observación
                    </th>

                    <th class="text-center">
                        Monto <i>($)</i>
                    </th>

                </tr>
            </thead>
            <tbody id="nueva">
                <tr>
                    <td>
                        <div class="btn-group btn-group-justified" data-toggle="buttons" style="display: inline">
                            <label class="btn btn-info btn-xs active styleButton" value="ing" onclick="acting(this)">
                                <input id="buttonsType" type="radio" name="options" value="ing" onclick="acttipo(this)" autocomplete="off" checked>Ingreso
                            </label>
                            <label class="btn btn-info btn-xs" value="cos" onclick="actcos(this)">
                                <input type="radio" name="options" value="cos" autocomplete="off">Costo
                            </label>
                            <label class="btn btn-info btn-xs" value="gas" onclick="actgas(this)">
                                <input type="radio" name="options" value="gas" autocomplete="off">Gasto
                            </label>
                            <label class="btn btn-info btn-xs" value="otr" onclick="actotr(this)">
                                <input type="radio" name="options" value="otr" autocomplete="off">Otro ing.
                            </label>
                        </div>
                    </td>
                    <td class="text-left ">
                        <textarea type="text" maxlength="140" placeholder="Cuenta (ejemplo: pago de impuestos)" rows='1' class="panel-info form-control-sm  inputForm inputForm3 fc sug nuev" id="ndescription" placeholder="" style="max-width: 100%; resize: none"></textarea>
                        <span class="text-danger" id="spanndescription" style="display: block"></span>
                    </td>
                    <td class="text-left ">
                        <textarea type="text" rows='1' maxlength="140" placeholder="(opcional)" class="panel-info form-control-sm  inputForm inputForm3 fc nuev" id="ncomment" placeholder="" style="max-width: 100%; resize: none"></textarea>
                        <span class="text-danger" style="display: block"></span>
                    </td>
                    <td class="">
                        <input type="number" class="panel-info form-control-sm inputForm inputForm3 montocentrado" style="width: 100px" value="1" id="namount" oninput="javascript:if (this.value > 9999999999) this.value = 9999999999;" onkeypress="solonumerosptocoma();" />
                        <span class="text-danger" style="display: block"></span>
                    </td>
                    <td style="border: none">
                        <button type="button" onkeypress="gotoButtons()" id="addn" class="btn btn-success btn-xs add" value="nueva" />
                        <span class="glyphicon glyphicon-plus"></span>
                    </td>
                </tr>
            </tbody>

        </table>
    </div>
</div>


<table id="encabezadostabla" class="table table-condensed table-bordered " style="margin-bottom: 2px">
    <thead>

        <tr class="text-center thStyleGradient3">
            <th class="text-left" style="width: 40%">
                Transacción
            </th>
            <th class="text-left" style="width: 40%">
                Observación
            </th>
            <th class="text-center" style="width: 20%">
                Monto ($)
            </th>
        </tr>
    </thead>
</table>

<legend class="thStyleGradient bordesRedond3 tipos col-lg-12 ">
    Ingresos
</legend>
<table id="ingresotabla" class="table table-condensed table-bordered ">

    <tbody id="ingreso">

        @foreach (var item in Model.Sheets)
        {
            if (item.SheetType == SheetType.Ingreso)
            {

                <tr>
                    <td class="text-left" style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.SheetDescription, new { @id = "iteming_SheetDescription" + @item.IdSheet, Name = "ing_SheetDescription", @onkeyup = "valdesc(this)", @oninput = "valdesc(this)", @onkeypress = "valdesc(this)", @class = "panel-info form-control-sm  inputForm withoutborders fc sugi", @rows = '1' })
                        <span class="text-danger" id="@("spaniteming_SheetDescription"+@item.IdSheet)" style="display: block"></span>


                    </td>
                    <td class="text-left" style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.Comments, new { @id = "iteming_Comments" + @item.IdSheet, Name = "ing_Comments", @class = "panel-info form-control-sm  inputForm withoutborders fc", @rows = '1' })
                    </td>
                    <td class="text-left">
                        @Html.TextBoxFor(modelItem => item.Amount, new { @id = "iteming_Amount" + @item.IdSheet, Name = "ing_Amount", @onkeyup = "maxvalue(this);calcing();calculogral();valamou(this)", @oninput = "maxvalue(this);calcing();calculogral();valamou(this)", @onkeypress = "solonumerosptocoma();valamou(this)", @class = "inputForm withoutborders panel-info montocentrado", @type="number" })
                        <span class="text-danger" id="@("spaniteming_Amount" + @item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width:2%">
                        <a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;" id="@item.IdSheet" onclick="borrarfilaing(this)"><span class="glyphicon glyphicon-remove"></span></a>
                    </td>
                </tr>}
        }
    </tbody>

</table>
<table id="totalingresotabla" class="table table-condensed table-bordered tottable" style="margin-bottom: 10px">
    <thead>
        <tr class="text-left" style="background: none">
            <th class="text-left" style="width: 40%; border-bottom: hidden; border-top: hidden;border-left:hidden">

            </th>
            <th class="text-right" style="width: 40%; font-weight: bolder;border-bottom: hidden; border-top: hidden; border-left: hidden;font-style: italic;font-size: medium;">
                Subtotal
            </th>

            <th class="text-left" id="toting" style="background: khaki;">
                @Html.TextBoxFor(model => model.Totali, new { @readonly = "readonly", @class = "totalView" })
            </th>
            <th style="width: 2%;border-bottom: hidden; border-top: hidden;border-right:hidden">

            </th>

        </tr>
    </thead>
</table>
<hr style="margin-top: 2px; margin-bottom: 5px; border-style: dashed" />

<legend class="thStyleGradient bordesRedond3 tipos col-lg-12 ">
    Costos
</legend>
<table id="costotabla" class="table table-condensed table-bordered ">

    <tbody id="costo">

        @foreach (var item in Model.Sheets)
        {
            if (item.SheetType == SheetType.Costo)
            {

                <tr>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.SheetDescription, new { @id = "itemcos_SheetDescription" + @item.IdSheet, Name = "cos_SheetDescription", @onkeyup = "valdesc(this)", @oninput = "valdesc(this)", @onkeypress = "valdesc(this)", @class = "panel-info form-control-sm withoutborders inputForm fc sugc", @rows = '1' })
                        <span class="text-danger" id="@("spanitemcos_SheetDescription"+@item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.Comments, new { @id = "itemcos_Comments" + @item.IdSheet, Name = "cos_Comments", @class = "panel-info form-control-sm withoutborders inputForm fc", @rows = '1' })
                    </td>
                    <td>
                        @Html.TextBoxFor(modelItem => item.Amount, new { @id = "itemcos_Amount" + @item.IdSheet, Name = "cos_Amount", @onkeyup = "maxvalue(this);calccos();calculogral();valamou(this)", @oninput = "maxvalue(this);calccos();calculogral();valamou(this)", @onkeypress = "solonumerosptocoma();valamou(this)", @class = "inputForm panel-info withoutborders montocentrado", @type = "number" })
                        <span class="text-danger" id="@("spanitemcos_Amount" + @item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width:2%"><a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;" id="@item.IdSheet" onclick="borrarfilacos(this)"><span class="glyphicon glyphicon-remove"></span></a>

                </tr>
            }
        }
    </tbody>

</table>
<table id="totalcostotabla" class="table table-condensed table-bordered tottable" style="margin-bottom: 10px">
    <thead>
        <tr class="text-left" style="background: none">
            <th class="text-left" style="width: 40%; border-bottom: hidden; border-top: hidden;border-left:hidden">

            </th>
            <th class="text-right" style="width: 40%; font-weight: bolder;border-bottom: hidden; border-top: hidden; border-left: hidden;font-style: italic;font-size: medium;">
                Subtotal
            </th>

            <th class="text-left" id="totcos" style="background: khaki;">
                @Html.TextBoxFor(model => model.Totalc, new { @readonly = "readonly", @class = "totalView" })
            </th>
            <th style="width: 2%;border-bottom: hidden; border-top: hidden;border-right:hidden">

            </th>

        </tr>
    </thead>
</table>
<hr style="margin-top: 2px; margin-bottom: 5px; border-style: dashed" />

<legend class="thStyleGradient bordesRedond3 tipos col-lg-12 ">
    Gastos
</legend>
<table id="gastotabla" class="table table-condensed table-bordered ">

    <tbody id="gasto">

        @foreach (var item in Model.Sheets)
        {
            if (item.SheetType == SheetType.Gasto)
            {
                <tr>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.SheetDescription, new { @id = "itemgas_SheetDescription" + @item.IdSheet, Name = "gas_SheetDescription", @onkeyup = "valdesc(this)", @oninput = "valdesc(this)", @onkeypress = "valdesc(this)", @class = "panel-info form-control-sm withoutborders inputForm fc sugg", @rows = '1' })
                        <span class="text-danger" id="@("spanitemgas_SheetDescription"+@item.IdSheet)" style="display: block"></span>

                    </td>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.Comments, new { @id = "itemgas_Comments" + @item.IdSheet, Name = "gas_Comments", @class = "panel-info form-control-sm withoutborders inputForm fc", @rows = '1' })
                    </td>
                    <td>
                        @Html.TextBoxFor(modelItem => item.Amount, new { @id = "itemgas_Amount" + @item.IdSheet, Name = "gas_Amount", @onkeyup = "maxvalue(this);calcgas();calculogral();valamou(this)", @oninput = "maxvalue(this);calcgas();calculogral();valamou(this)", @onkeypress = "solonumerosptocoma();valamou(this)", @class = "inputForm panel-info withoutborders montocentrado", @type = "number" })
                        <span class="text-danger" id="@("spanitemgas_Amount" + @item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width:2%"><a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;" id="@item.IdSheet" onclick="borrarfilagas(this)"><span class="glyphicon glyphicon-remove"></span></a>

                </tr>
            }
        }
    </tbody>

</table>
<table id="totalgastotabla" class="table table-condensed table-bordered tottable " style="margin-bottom: 10px">
    <thead>
        <tr class="text-left" style="background: none">
            <th class="text-left" style="width: 40%; border-bottom: hidden; border-top: hidden;border-left:hidden">

            </th>
            <th class="text-right" style="width: 40%; font-weight: bolder;border-bottom: hidden; border-top: hidden; border-left: hidden;font-style: italic;font-size: medium;">
                Subtotal
            </th>

            <th class="text-left" id="totgas" style="background: khaki;">
                @Html.TextBoxFor(model => model.Totalg, new { @readonly = "readonly", @class = "totalView" })
            </th>
            <th style="width: 2%;border-bottom: hidden; border-top: hidden;border-right:hidden">

            </th>

        </tr>
    </thead>
</table>
<hr style="margin-top: 2px; margin-bottom: 5px; border-style: dashed" />

<legend class="thStyleGradient bordesRedond3 tipos col-lg-12 ">
    Otros ingresos
</legend>

<table id="otrotabla" class="table table-condensed table-bordered ">

    <tbody id="otro">

        @foreach (var item in Model.Sheets)
        {
            if (item.SheetType == SheetType.OtroIngreso)
            {

                <tr>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.SheetDescription, new { @id = "itemotr_SheetDescription" + @item.IdSheet, Name = "otr_SheetDescription", @onkeyup = "valdesc(this)", @oninput = "valdesc(this)", @onkeypress = "valdesc(this)", @class = "panel-info form-control-sm withoutborders inputForm fc sugo", @rows = '1' })
                        <span class="text-danger" id="@("spanitemotr_SheetDescription"+@item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width: 40%;">
                        @Html.TextAreaFor(modelItem => item.Comments, new { @id = "itemotr_Comments" + @item.IdSheet, Name = "otr_Comments", @class = "panel-info form-control-sm withoutborders inputForm fc", @rows = '1' })
                    </td>
                    <td>
                        @Html.TextBoxFor(modelItem => item.Amount, new { @id = "itemotr_Amount" + @item.IdSheet, Name = "otr_Amount", @onkeyup = "maxvalue(this);calcotr();calculogral();valamou(this)", @oninput = "maxvalue(this);calcotr();calculogral();valamou(this)", @onkeypress = "solonumerosptocoma();valamou(this)", @class = "inputForm panel-info withoutborders montocentrado", @type = "number" })
                        <span class="text-danger" id="@("spanitemotr_Amount" + @item.IdSheet)" style="display: block"></span>


                    </td>
                    <td style="width:2%"><a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;" id="@item.IdSheet" onclick="borrarfilaotr(this)"><span class="glyphicon glyphicon-remove"></span></a>

                </tr>
            }
        }
    </tbody>
</table>
<table id="totalotrotabla" class="table table-condensed table-bordered tottable" style="margin-bottom: 10px">
    <thead>
        <tr class="text-left" style="background: none">
            <th class="text-left" style="width: 40%; border-bottom: hidden; border-top: hidden;border-left:hidden">

            </th>
            <th class="text-right" style="width: 40%; font-weight: bolder;border-bottom: hidden; border-top: hidden; border-left: hidden;font-style: italic;font-size: medium;">
                Subtotal
            </th>

            <th class="text-left" id="tototr" style="background: khaki;">
                @Html.TextBoxFor(model => model.Totalo, new { @readonly = "readonly", @class = "totalView" })
            </th>
            <th style="width: 2%;border-bottom: hidden; border-top: hidden;border-right:hidden">

            </th>

        </tr>
    </thead>
</table>

<hr style="margin-top: 2px; margin-bottom: 5px; border-style: dashed" />
<legend class="tipos text-center thStyleGradient2 bordesRedond ">
    Resumen
</legend>
<table id="resumentabla" class="table table-condensed   table-bordered " style="table-layout: fixed">

    <thead>
        <tr class="text-center thStyleGradient3 tipos">
            <td class="text-left" style="border-radius: 3px; font-weight: bold">
                Obs. Grales.
            </td>
            <td class="text-center" style="border-radius: 3px; width: 200px; font-weight: bold">
                Total
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                @Html.TextAreaFor(model => model.Comments, new { @class = "panel-info form-control-sm  inputForm withoutborders fc", @rows = '1', @maxlength = "140" })


            </td>
            <td style="background: khaki;">
                @Html.TextBoxFor(model => model.TotalAmount, new { @readonly = "readonly", @class = "totalView" })
                <span class="text-danger" style="display: block"></span>
            </td>
        </tr>

    </tbody>

</table>

<hr style="color: grey"/>
<div style="width: 100%; display: flex">
    <div style="width: 25%; text-align: left">
        <a href="@Url.Action("Index", "Worksheets")" class="btn btn-primary btn-md"><span class="glyphicon glyphicon-hand-left " aria-hidden="true"></span>&nbsp; Volver</a>
    </div>
    <div style="width: 50%; text-align: center">
        <button type="button" id="guardar" class="btn btn-success btn-md " value="Guardar">
            Guardar &nbsp;<span class="glyphicon glyphicon-floppy-disk"></span>
        </button>
    </div>
    <div style="width: 25%"></div>
</div>


<div id="GSCCModal" class="modal fade" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width:100%">
        <div class="modal-content" style="width: 84%; left: 8%">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="font-size: xx-large">&times;</button>
                <h4 class="modal-title text-center">Ayuda</h4>
            </div>
            <div class="modal-body">
                @Html.Action("HelpEdit", "Worksheets")
            </div>
            <div class="modal-footer" style="text-align: center">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>

    </div>

</div>


@section Scripts{
    <script src="@Url.Content("~/Scripts/solonumerosptocoma.js")"></script>
    <script src="@Url.Content("~/Scripts/maxvalue.js")"></script>
    <script>
        var sinrequerido = false;
        $( document ).ready(function() {
            
            $(".fc").attr('maxlength', "140");
            $(".montocentrado").attr('maxlength', "10");
      
            $('#Date').datepicker({
                format: "MM/yyyy",
                startView: 1,
                minViewMode: 1,
                maxViewMode: 2,
                todayBtn: "linked",
                clearBtn: true,
                language: "es",
                autoclose: true,todayHighlight: true

            });
        
           
        
        });


        $("#mostrar").click(function() {
            $("#mostrar").hide();
            $("#nuevalinea").toggle("slow");

        });
        $("#ocultar").click(function() {
            $("#nuevalinea").toggle("slow");
            $("#mostrar").toggle("slow");
        });

        
        function valwd() {

            if (sinrequerido) {
            var periodo = traducirmes($('#Date').val());
            console.log(periodo);
            if (periodo == ''| periodo == null) {
                $('#wdate').html('Requerido');
                valf = 1;
            } else {
                var options3 = {};
                options3.url = '@Url.Action("ExistePlanillaEdit", "Worksheets")';
                options3.type = "GET";
                options3.data = { "fecha": periodo, "idp": @Model.IdWorksheet };
                options3.dataType = "json";
                options3.success = function(data) {
                    if (data) {
                        $('#wdate').html('Período existente.');
                        valf = 1;
                    } else {
                        $('#wdate').html('');
                        valf = 0;
                    };

                };
                $.ajax(options3);
            }

            }else {
                sinrequerido = true;

            }}
        

        function valdesc(x) {
            var a = x.id;
            if (x.value.trim() == "" || x.value == null) {
                $('#span' + a).html('Requerido.');

            } else {
                $('#span' + a).html('');
            };
        }
        function valdescb(x) {
            if (x.value.trim() == "" || x.value == null) {

                $(x).closest('td').find('.text-danger').html('Requerido.');

            } else {
                $(x).closest('td').find('.text-danger').html('');
            };
        }

        function valamou(x) {
            var a = x.id;
            if (x.value.trim() == "" || x.value == null) {
                $('#span' + a).html('Requerido.');

            } else {
                if (x.value.trim() < 0) {
                    $('#span' + a).html('No puede ser menor a 0.');
                } else {
                    $('#span' + a).html('');
                }
            };
        }
        function valamoub(x) {
            if (x.value.trim() == "" || x.value == null) {
                $(x).siblings('span.text-danger').html('Requerido.');

            } else {
                if (x.value.trim() < 0) {
                    $(x).siblings('span.text-danger').html('No puede ser menor a 0.');
                } else {
                    $(x).siblings('span.text-danger').html('');
                }
            };
        }

        function calcing() {
            ting = 0;
            $.each(itemsiamounts, function() { ting += parseFloat(this) || 0; });
            document.getElementById("Totali").value = ting.toFixed(2);
        }

        function calccos() {
            tcos = 0;
            $.each(itemscamounts, function() { tcos += parseFloat(this) || 0; });
            document.getElementById("Totalc").value = tcos.toFixed(2);
        }

        function calcgas() {
            tgas = 0;
            $.each(itemsgamounts, function() { tgas += parseFloat(this) || 0; });
            document.getElementById("Totalg").value = tgas.toFixed(2);
        }

        function calcotr() {
            totr = 0;
            $.each(itemsoamounts, function() { totr += parseFloat(this) || 0; });
            document.getElementById("Totalo").value = totr.toFixed(2);
        }

        function gotoButtons() {

            $("#buttonsType").focus();
        }

        function arraysamountsedit() {
            itemsi = [];
            itemsiamounts = [];
            itemsc = [];
            itemscamounts = [];
            itemsg = [];
            itemsgamounts = [];
            itemso = [];
            itemsoamounts = [];

            $("input[name='ing_Amount']").map(function() { itemsiamounts.push(parseFloat(this.value)) });
            $("input[name='cos_Amount']").map(function() { itemscamounts.push(parseFloat(this.value)) });
            $("input[name='gas_Amount']").map(function() { itemsgamounts.push(parseFloat(this.value)) });
            $("input[name='otr_Amount']").map(function() { itemsoamounts.push(parseFloat(this.value)) });

        }

        function arraysedit() {
            itemsi = [];
            itemsidescriptions = [];
            itemsicomments = [];
            itemsiamounts = [];

            itemsc = [];
            itemscdescriptions = [];
            itemsccomments = [];
            itemscamounts = [];

            itemsg = [];
            itemsgdescriptions = [];
            itemsgcomments = [];
            itemsgamounts = [];

            itemso = [];
            itemsodescriptions = [];
            itemsocomments = [];
            itemsoamounts = [];
            $("textarea[name='ing_SheetDescription']").map(function() { itemsidescriptions.push((this.value)) });
            $("textarea[name='ing_Comments']").map(function() { itemsicomments.push((this.value)) });
            $("input[name='ing_Amount']").map(function() { itemsiamounts.push(parseFloat(this.value)) });

            $("textarea[name='cos_SheetDescription']").map(function() { itemscdescriptions.push((this.value)) });
            $("textarea[name='cos_Comments']").map(function() { itemsccomments.push((this.value)) });
            $("input[name='cos_Amount']").map(function() { itemscamounts.push(parseFloat(this.value)) });

            $("textarea[name='gas_SheetDescription']").map(function() { itemsgdescriptions.push((this.value)) });
            $("textarea[name='gas_Comments']").map(function() { itemsgcomments.push((this.value)) });
            $("input[name='gas_Amount']").map(function() { itemsgamounts.push(parseFloat(this.value)) });

            $("textarea[name='otr_SheetDescription']").map(function() { itemsodescriptions.push((this.value)) });
            $("textarea[name='otr_Comments']").map(function() { itemsocomments.push((this.value)) });
            $("input[name='otr_Amount']").map(function() { itemsoamounts.push(parseFloat(this.value)) });


            for (i = 0; i < itemsidescriptions.length; i++) {

                itemsi.push({
                    SheetDescription: itemsidescriptions[i],
                    Comments: itemsicomments[i],
                    Amount: itemsiamounts[i],
                    SheetType: 0

                });
            }

            for (i = 0; i < itemscdescriptions.length; i++) {

                itemsc.push({
                    SheetDescription: itemscdescriptions[i],
                    Comments: itemsccomments[i],
                    Amount: itemscamounts[i],
                    SheetType: 1

                });
            }
            for (i = 0; i < itemsgdescriptions.length; i++) {

                itemsg.push({
                    SheetDescription: itemsgdescriptions[i],
                    Comments: itemsgcomments[i],
                    Amount: itemsgamounts[i],
                    SheetType: 2

                });
            }
            for (i = 0; i < itemsodescriptions.length; i++) {

                itemso.push({
                    SheetDescription: itemsodescriptions[i],
                    Comments: itemsocomments[i],
                    Amount: itemsoamounts[i],
                    SheetType: 3

                });
            }
        }

        function calculogral() {
            arraysamountsedit();
            tgral = 0;
            $.each(itemsiamounts, function() { tgral += parseFloat(this) || 0; });
            $.each(itemsoamounts, function() { tgral += parseFloat(this) || 0; });
            $.each(itemsgamounts, function() { tgral -= parseFloat(this) || 0; });
            $.each(itemscamounts, function() { tgral -= parseFloat(this) || 0; });
            document.getElementById("TotalAmount").value = tgral.toFixed(2);
        }

        function borrarfilaing(row) {
            var a = row.id;
            toastr.warning("-" + $('#iteming_SheetDescription' + a).val() + "-<br/>Eliminado.", "Ingreso:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }

        function borrarfilaingb(row) {
            var a = $(row).closest('td').siblings(':first-child').text();

            toastr.warning("-" + a + "-<br/>Eliminado.", "Ingreso:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }

        function borrarfilacos(row) {
            var a = row.id;
            toastr.warning("-" + $('#itemcos_SheetDescription' + a).val() + "-<br/>Eliminado.", "Costo:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }
        function borrarfilacosb(row) {
            var a = $(row).closest('td').siblings(':first-child').text();
            toastr.warning("-" + a + "-<br/>Eliminado.", "Costo:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }

        function borrarfilagas(row) {
            var a = row.id;
            toastr.warning("-" + $('#itemgas_SheetDescription' + a).val() + "-<br/>Eliminado.", "Gasto:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }
        function borrarfilagasb(row) {
            var a = $(row).closest('td').siblings(':first-child').text();
            toastr.warning("-" + a + "-<br/>Eliminado.", "Gasto:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }

        function borrarfilaotr(row) {
            var a = row.id;
            toastr.warning("-" + $('#itemotr_SheetDescription' + a).val() + "-<br/>Eliminado.", "Otro ingreso:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }
        function borrarfilaotrb(row) {
            var a = $(row).closest('td').siblings(':first-child').text();

            toastr.warning("-" + a + "-<br/>Eliminado.", "Otro ingreso:");
            row.closest('tr').remove();
            arraysamountsedit();
            calcing();
            calccos();
            calcgas();
            calcotr();
            calculogral();
        }


        function acting(a) { tipo = "ing"; }

        function actcos(a) { tipo = "cos"; }

        function actgas(a) { tipo = "gas"; }

        function actotr(a) { tipo = "otr"; }

        function renewi() {
            orderItemsi = [];
            orderItemsidescriptions = [];
            orderItemsicomments = [];
            orderItemsiamounts = [];

            $("textarea[id='ing_SheetDescriptionz']").map(function() { orderItemsidescriptions.push((this.value)) });
            $("textarea[id='ing_Commentsz']").map(function() { orderItemsicomments.push((this.value)) });
            $("input[id='ing_Amountz']").map(function() { orderItemsiamounts.push(parseFloat(this.value)) });

            for (i = 0; i < orderItemsidescriptions.length; i++) {

                orderItemsi.push({
                    SheetDescription: orderItemsidescriptions[i],
                    Comments: orderItemsicomments[i],
                    Amount: orderItemsiamounts[i],
                    SheetType: 0

                });
            }

        }
        function renewc() {


            orderItemsc = [];
            orderItemscdescriptions = [];
            orderItemsccomments = [];
            orderItemscamounts = [];

            $("textarea[id='cos_SheetDescriptionz']").map(function() { orderItemscdescriptions.push((this.value)) });
            $("textarea[id='cos_Commentsz']").map(function() { orderItemsccomments.push((this.value)) });
            $("input[id='cos_Amountz']").map(function() { orderItemscamounts.push(parseFloat(this.value)) });

            for (i = 0; i < orderItemscdescriptions.length; i++) {

                orderItemsc.push({
                    SheetDescription: orderItemscdescriptions[i],
                    Comments: orderItemsccomments[i],
                    Amount: orderItemscamounts[i],
                    SheetType: 1

                });
            }

        }

        function renewg() {
            orderItemsg = [];
            orderItemsgdescriptions = [];
            orderItemsgcomments = [];
            orderItemsgamounts = [];

            $("textarea[id='gas_SheetDescriptionz']").map(function() { orderItemsgdescriptions.push((this.value)) });
            $("textarea[id='gas_Commentsz']").map(function() { orderItemsgcomments.push((this.value)) });
            $("input[id='gas_Amountz']").map(function() { orderItemsgamounts.push(parseFloat(this.value)) });

            for (i = 0; i < orderItemsgdescriptions.length; i++) {

                orderItemsg.push({
                    SheetDescription: orderItemsgdescriptions[i],
                    Comments: orderItemsgcomments[i],
                    Amount: orderItemsgamounts[i],
                    SheetType: 2

                });
            }

        }

        function renewo() {
            orderItemso = [];
            orderItemsodescriptions = [];
            orderItemsocomments = [];
            orderItemsoamounts = [];

            $("textarea[id='otr_SheetDescriptionz']").map(function() { orderItemsodescriptions.push((this.value)) });
            $("textarea[id='otr_Commentsz']").map(function() { orderItemsocomments.push((this.value)) });
            $("input[id='otr_Amountz']").map(function() { orderItemsoamounts.push(parseFloat(this.value)) });

            for (i = 0; i < orderItemsodescriptions.length; i++) {

                orderItemso.push({
                    SheetDescription: orderItemsodescriptions[i],
                    Comments: orderItemsocomments[i],
                    Amount: orderItemsoamounts[i],
                    SheetType: 3

                });
            }
        }


        function isug() {
            $.each($(".sug"), function()
            {

                if($(this).hasClass("awe")==false){$(this).addClass("awe"); new Awesomplete(this, {
                    list: linesarray});}
            });
            $.each($(".sugi"), function()
            {

                if($(this).hasClass("awe")==false){$(this).addClass("awe"); new Awesomplete(this, {
                    list: linesiarray});}
            });
            $.each($(".sugc"), function()
            {

                if($(this).hasClass("awe")==false){$(this).addClass("awe"); new Awesomplete(this, {
                    list: linescarray});}
            });
            $.each($(".sugg"), function()
            {

                if($(this).hasClass("awe")==false){$(this).addClass("awe"); new Awesomplete(this, {
                    list: linesgarray});}
            });
            $.each($(".sugo"), function()
            {

                if($(this).hasClass("awe")==false){$(this).addClass("awe"); new Awesomplete(this, {
                    list: linesoarray});}
            });
        }
        function itextarea(){$('textarea').each(function() {
            autosize(this);
            this.style.display = '';
            autosize.update(this);
            isug();

        });}



        $(document).ready(function() {
            lines = @Html.Raw(ViewBag.lines);
            linesi = @Html.Raw(ViewBag.linesi);
            linesc = @Html.Raw(ViewBag.linesc);
            linesg = @Html.Raw(ViewBag.linesg);
            lineso = @Html.Raw(ViewBag.lineso);
            linesarray = [];
            linesiarray = [];
            linescarray = [];
            linesgarray = [];
            linesoarray = [];
            $.each(lines, function(index, value) {
                linesarray.push(value);

            }); $.each(linesi, function(index, value) {
                linesiarray.push(value);

            }); $.each(linesc, function(index, value) {
                linescarray.push(value);

            }); $.each(linesg, function(index, value) {
                linesgarray.push(value);

            }); $.each(lineso, function(index, value) {
                linesoarray.push(value);

            });

            itextarea();
            valf = 0;
            tipo = "ing";

            orderItems = [];
            orderItemsi = [];
            orderItemsc = [];
            orderItemsg = [];
            orderItemso = [];

            toting = [];
            totcos = [];
            totgas = [];
            tototr = [];
            arraysamountsedit();


        });


        /////ADD click ////////
        ///////////////////////
        $('#addn').click(function() {
            arraysamountsedit();


            var isValidItem = true;

            //Check validation of order item
            if ($('#ndescription').val().trim() == '') {
                isValidItem = false;
                $('#spanndescription').html('Requerido');
            } else {
                $('#spanndescription').html('');
            }

            if ($('#namount').val().trim() == '') {
                isValidItem = false;
                $('#namount').siblings('span.text-danger').html('Requerido');
            } else {
                if ($('#namount').val().trim() < 0) {
                    isValidItem = false;
                    $('#namount').siblings('span.text-danger').html('No puede ser menor a 0.');
                } else {
                    $('#namount').siblings('span.text-danger').html('');
                }
            }


            if (isValidItem) {


                var SheetDescription = $('#ndescription').val().trim();
                var Amount = $('#namount').val().trim();
                var Comments = $('#ncomment').val().trim();

                if (tipo == "ing") {
                    renewi();
                    var SheetType = 0;
                    orderItemsi.push({
                        SheetDescription: SheetDescription,
                        Amount: Amount,
                        Comments: Comments,
                        SheetType: SheetType
                    });

                    toastr.info("-" + SheetDescription + "-<br/>Agregado.", "Ingreso:");
                    ingreso();
                };
                if (tipo == "cos") {
                    renewc();
                    var SheetType = 1;
                    orderItemsc.push({
                        SheetDescription: SheetDescription,
                        Amount: Amount,
                        Comments: Comments,
                        SheetType: SheetType
                    });

                    toastr.info("-" + SheetDescription + "-<br/>Agregado.", "Costo:");
                    costo();
                };
                if (tipo == "gas") {
                    renewg();
                    var SheetType = 2;
                    orderItemsg.push({
                        SheetDescription: SheetDescription,
                        Amount: Amount,
                        Comments: Comments,
                        SheetType: SheetType
                    });

                    toastr.info("-" + SheetDescription + "-<br/>Agregado.", "Gasto:");
                    gasto();
                };
                if (tipo == "otr") {
                    renewo();
                    var SheetType = 3;
                    orderItemso.push({
                        SheetDescription: SheetDescription,
                        Amount: Amount,
                        Comments: Comments,
                        SheetType: SheetType
                    });

                    toastr.info("-" + SheetDescription + "-<br/>Agregado.", "Otro ingreso:");
                    otro();
                };
                $('#ndescription,#namount,#ncomment').val('');
                $('.nuev').each(function() {
                    autosize(this);
                    this.style.display = '';
                    autosize.update(this);
                });
            }


        });


        /////Fin ADD click/////
        ///////////////////////

        //functiones agregar ing cos gas otr/////////////
        /////////////////////
        function ingreso() {

            $('.elimi').remove();
            if (orderItemsi.length > 0) {
                $('#orderItemsi').html('<span class="text-danger"></span>');
                $.each(orderItemsi, function(i, val) {
                    var $rowi = $('<tr class="elimi"></tr>');

                    $rowi.append($('<td style="width: 40%"><textarea maxlength="140" id="ing_SheetDescriptionz" Name="ing_SheetDescription" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc sugi awesomplete" value="'+val.SheetDescription+'" onkeyup = "valdescb(this)" oninput = "valdescb(this)" onkeypress = "valdescb(this)">'+val.SheetDescription+'</textarea><span class="text-danger"></span></td>'));
                    $rowi.append($('<td style="width: 40%"><textarea maxlength="140" id="ing_Commentsz" Name="ing_Comments" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc" value="'+val.Comments+'">'+val.Comments+'</textarea><span class="text-danger"></span></td>'));
                    $rowi.append($('<td><input type="number" id="ing_Amountz" maxlength="10" Name="ing_Amount"  rows="1" class= "panel-info form-control-sm inputForm withoutborders fc montocentrado" value="'+val.Amount+'"onkeyup = "maxvalue(this);calculogral();calcing();valamoub(this)",  oninput = "maxvalue(this);calculogral();calcing();valamoub(this)" onkeypress = "solonumerosptocoma();valamoub(this)"><span class="text-danger"></span></td>'));

                    var $removei = $('<a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;"  onclick="borrarfilaingb(this)"><span class="glyphicon glyphicon-remove"></span></a>');


                    $removei.click(function(e) {
                        e.preventDefault();
                        orderItemsi.splice(i, 1);
                        renewi();

                        ingreso();
                        //CALCULO TOTAL ing
                        arraysamountsedit();
                        calcing();


                        //FIN CALCULO TOTAL ing
                        //calculo total gral
                        calculogral();
                        //fin calculo total gral
                    });
                    $rowi.append($('<td style="width:2%"></td>').append($removei));
                    $('#ingresotabla > tbody:last').append($rowi);
                    //CALCULO TOTAL ing
                    arraysamountsedit();
                    calcing();

                    //FIN CALCULO TOTAL ing
                    //calculo total gral
                    itextarea();
                    calculogral();
                    //fin calculo total gral

                });
            } else {
                $('#orderItemsi').html('');
            }
        }

        function costo() {

            $('.elimc').remove();
            if (orderItemsc.length > 0) {
                $('#orderItemsc').html('<span class="text-danger"></span>');
                $.each(orderItemsc, function(i, val) {
                    var $rowc = $('<tr class="elimc"  style="background-color: white"></tr>');

                    $rowc.append($('<td style="width: 40%"><textarea maxlength="140" id="cos_SheetDescriptionz" Name="cos_SheetDescription" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc sugc" value="'+val.SheetDescription+'" onkeyup = "valdescb(this)" oninput = "valdescb(this)" onkeypress = "valdescb(this)">'+val.SheetDescription+'</textarea><span class="text-danger"></span></td>'));
                    $rowc.append($('<td style="width: 40%"><textarea maxlength="140" id="cos_Commentsz"  Name="cos_Comments" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc" value="'+val.Comments+'">'+val.Comments+'</textarea><span class="text-danger"></span></td>'));
                    $rowc.append($('<td><input type="number" id="cos_Amountz" maxlength="10" Name="cos_Amount" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc montocentrado" value="'+val.Amount+'"onkeyup = "maxvalue(this);calculogral();calccos();valamoub(this)",  oninput = "maxvalue(this);calculogral();calccos();valamoub(this)" onkeypress = "solonumerosptocoma();valamoub(this)"><span class="text-danger"></span></td>'));
                    var $removec = $('<a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;"   onclick="borrarfilacosb(this)"><span class="glyphicon glyphicon-remove"></span></a>');
                    $removec.click(function(e) {
                        e.preventDefault();
                        orderItemsc.splice(i, 1);
                        renewc();

                        costo();
                        //CALCULO TOTAL cos
                        arraysamountsedit();

                        calccos();

                        //FIN CALCULO TOTAL cos
                        //calculo total gral
                        calculogral();
                        //fin calculo total gral
                    });
                    $rowc.append($('<td style="width: 2%"></td>').append($removec));
                    $('#costotabla > tbody:last').append($rowc);
                    //CALCULO TOTAL cos
                    arraysamountsedit();

                    calccos();

                    //FIN CALCULO TOTAL cos
                    //calculo total gral
                    itextarea();
                    calculogral();
                    //fin calculo total gral

                });
            } else {
                $('#orderItemsc').html('');
            }
        }

        function gasto() {

            $('.elimg').remove();
            if (orderItemsg.length > 0) {
                $('#orderItemsg').html('<span class="text-danger"></span>');
                $.each(orderItemsg, function(i, val) {
                    var $rowg = $('<tr class="elimg"  style="background-color: white"></tr>');
                    $rowg.append($('<td style="width: 40%"><textarea maxlength="140" id="gas_SheetDescriptionz" Name="gas_SheetDescription" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc sugg" value="'+val.SheetDescription+'" onkeyup = "valdescb(this)" oninput = "valdescb(this)" onkeypress = "valdescb(this)">'+val.SheetDescription+'</textarea><span class="text-danger"></span></td>'));
                    $rowg.append($('<td style="width: 40%"><textarea maxlength="140" id="gas_Commentsz" Name="gas_Comments" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc" value="'+val.Comments+'">'+val.Comments+'</textarea><span class="text-danger"></span></td>'));
                    $rowg.append($('<td><input type="number" id="gas_Amountz" maxlength="10" Name="gas_Amount" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc montocentrado" value="'+val.Amount+'"onkeyup = "maxvalue(this);calcgas();calculogral();valamoub(this)",  oninput = "maxvalue(this);calcgas();calculogral();valamoub(this)" onkeypress = "solonumerosptocoma();valamoub(this)"><span class="text-danger"></span></td>'));

                    var $removeg = $('<a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;"  onclick="borrarfilagasb(this)"><span class="glyphicon glyphicon-remove"></span></a>');





                    $removeg.click(function(e) {
                        e.preventDefault();
                        orderItemsg.splice(i, 1);
                        renewg();

                        gasto();
                        //CALCULO TOTAL gas
                        arraysamountsedit();

                        calcgas();

                        //FIN CALCULO TOTAL gas
                        //calculo total gral
                        calculogral();
                        //fin calculo total gral
                    });
                    $rowg.append($('<td style="width: 2%"></td>').append($removeg));
                    $('#gastotabla > tbody:last').append($rowg);
                    //CALCULO TOTAL gas
                    arraysamountsedit();

                    calcgas();

                    //FIN CALCULO TOTAL gas
                    //calculo total gral
                    calculogral();
                    //fin calculo total gral
                    itextarea();

                });
            } else {
                $('#orderItemsg').html('');
            }
        }

        function otro() {

            $('.elimo').remove();
            if (orderItemso.length > 0) {
                $('#orderItemso').html('<span class="text-danger"></span>');
                $.each(orderItemso, function(i, val) {
                    var $rowo = $('<tr class="elimo"  style="background-color: white"></tr>');

                    $rowo.append($('<td style="width: 40%"><textarea maxlength="140" id="otr_SheetDescriptionz"  Name="otr_SheetDescription" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc sugo" value="'+val.SheetDescription+'" onkeyup = "valdescb(this)" oninput = "valdescb(this)" onkeypress = "valdescb(this)">'+val.SheetDescription+'</textarea><span class="text-danger"></span></td>'));
                    $rowo.append($('<td style="width: 40%"><textarea maxlength="140" id="otr_Commentsz" Name="otr_Comments" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc" value="'+val.Comments+'">'+val.Comments+'</textarea><span class="text-danger"></span></td>'));
                    $rowo.append($('<td><input type="number" id="otr_Amountz" Name="otr_Amount" rows="1" class= "panel-info form-control-sm inputForm withoutborders fc montocentrado" value="'+val.Amount+'"onkeyup = "maxvalue(this);calcotr();calculogral();valamoub(this)",  oninput = "maxvalue(this);calcotr();calculogral();valamoub(this)" onkeypress = "solonumerosptocoma();valamoub(this)"><span class="text-danger"></span></td>'));

                    var $removeo = $('<a style="color:red; width: 37px; text-align: center;vertical-align: -webkit-baseline-middle;"  onclick="borrarfilaotrb(this)"><span class="glyphicon glyphicon-remove"></span></a>');




                    $removeo.click(function(e) {
                        e.preventDefault();
                        orderItemso.splice(i, 1);
                        renewo();

                        otro();
                        //CALCULO TOTAL otr
                        arraysamountsedit();

                        calcotr();
                        //FIN CALCULO TOTAL otr
                        //calculo total gral
                        calculogral();
                        //fin calculo total gral
                    });
                    $rowo.append($('<td style="width: 2%"></td>').append($removeo));
                    $('#otrotabla > tbody:last').append($rowo);
                    //CALCULO TOTAL otr
                    arraysamountsedit();
                    itextarea();

                    calcotr();
                    //FIN CALCULO TOTAL otr
                    //calculo total gral
                    calculogral();
                    //fin calculo total gral

                });
            } else {
                $('#orderItemso').html('');
            }
        }

        //////fin funciones agregar ing cos gas otr///////
        //////////////////////////

        ////spaniteming_SheetDescription

        $('#guardar').click(function() {

            var required = false;

            $("textarea[name='ing_SheetDescription']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spaniteming_SheetDescription' + b).html('Requerido');

                    required = true;
                } else {
                    $('#spaniteming_SheetDescription' + b).html('');
                }

            });

            $("textarea[name='cos_SheetDescription']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemcos_SheetDescription' + b).html('Requerido');
                    required = true;
                } else {
                    $('#spanitemcos_SheetDescription' + b).html('');
                }

            });

            $("textarea[name='gas_SheetDescription']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemgas_SheetDescription' + b).html('Requerido');
                    required = true;
                } else {
                    $('#spanitemgas_SheetDescription' + b).html('');
                }

            });

            $("textarea[name='otr_SheetDescription']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemotr_SheetDescription' + b).html('Requerido');
                    required = true;
                } else {
                    $('#spanitemotr_SheetDescription' + b).html('');
                }

            });
            $("input[name='ing_Amount']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spaniteming_Amount' + b).html('Requerido');
                    required = true;
                } else {
                    if (this.value.trim() < 0) {
                        $('#spaniteming_Amount' + b).html('No puede ser menor a 0.');
                        required = true;
                    } else {
                        $('#spaniteming_Amount' + b).html('');

                    }
                }
            });
            $("input[name='cos_Amount']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemcos_Amount' + b).html('Requerido');

                    required = true;
                } else {
                    if (this.value.trim() < 0) {
                        $('#spanitemcos_Amount' + b).html('No puede ser menor a 0.');

                        required = true;
                    } else {
                        $('#spanitemcos_Amount' + b).html('');

                    }
                }
            });
            $("input[name='gas_Amount']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemgas_Amount' + b).html('Requerido');

                    required = true;
                } else {
                    if (this.value.trim() < 0) {
                        $('#spanitemgas_Amount' + b).html('No puede ser menor a 0.');

                        required = true;
                    } else {
                        $('#spanitemgas_Amount' + b).html('');

                    }
                }
            });
            $("input[name='otr_Amount']").map(function() {
                var a = this.id;

                var b = a.replace(/\D/g, '');
                if (this.value.trim() == "" || this.value == null) {
                    $('#spanitemotr_Amount' + b).html('Requerido.');

                    required = true;
                } else {
                    if (this.value.trim() < 0) {
                        $('#spanitemotr_Amount' + b).html('No puede ser menor a 0.');

                        required = true;
                    } else {
                        $('#spanitemotr_Amount' + b).html('');

                    }
                }
            });

            if (valf == 1) {
                required = true;
                toastr["error"]("El período ingresado ya existe.");
            }

            //if (itemsi.length == 0 & itemsc.length == 0 & itemsg.length == 0 & itemso.length == 0) {
            //    required = true;

            //    toastr["error"]("Es necesario agregar al menos una transacción para guardar la planilla. ");
            //}

            if (required) {
                toastr["error"]("Uno o más campos son incorrectos.","Error al guardar");

            } else {


                bootbox.confirm({message:"** Está por confirmar la edición, ¿Desea continuar?", 
                    buttons: {
                        confirm: {
                            label: 'Aceptar',
                            className: 'btn-success'
                        },
                        cancel: {
                            label: 'Cancelar',
                            className: 'btn-default'
                        }
                    },
                    callback:function(result1) {
                       

                    if (result1) {
                        $("#loader").show();

                        arraysedit();
                        orderItems = $.merge(itemsi, itemsc);
                        orderItems = $.merge(orderItems, itemsg);
                        orderItems = $.merge(orderItems, itemso);
                        
                        if (orderItems.length == 0 ) {
                            $("#loader").hide();
                            toastr["error"]("Es necesario agregar al menos una transacción para guardar la planilla. ");
                        }
                        else{

                        var data = {
                            IdWorkSheet: @Model.IdWorksheet,
                            Date: $('#Date').val().trim(),
                            Comments: $('#Comments').val().trim(),
                            Sheets: orderItems,
                            Totali: $('#Totali').val().trim(),
                            Totalc: $('#Totalc').val().trim(),
                            Totalg: $('#Totalg').val().trim(),
                            Totalo: $('#Totalo').val().trim(),
                            TotalAmount: $('#TotalAmount').val().trim()
                        }
                        $.ajax({
                            url: '@Url.Action("EditW", "Worksheets")',
                            type: "POST",
                            data: JSON.stringify(data),
                            dataType: "JSON",
                            contentType: "application/json",
                            success: function(d) {
                                //check is successfully save to database


                                if (d.status == true) {

                                    var url = '@Url.Action("Index", "Worksheets", new {x = 2})';
                                    window.location.href = url;
                                } else {
                                    bootbox.alert(d.mensaje);
                                }
                                
                                //$('#submit').val('Save');
                            },
                            error: function() {
                                $("#loader").hide();

                                toastr["error"]("Es necesario agregar al menos una entrada para guardar la planilla. ");
                                
                            }
                        });
                    }


                        }}});
            }


        });
        

    </script>




}
